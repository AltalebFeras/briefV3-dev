<form [formGroup]="form" (ngSubmit)="onSubmit()" class="person-form">
  <h2>Ajouter une personne</h2>

  <!-- Message d'erreur global -->
  <div class="error-message" *ngIf="errorMessage">
    {{ errorMessage }}
  </div>

  <!-- Prénom -->
  <div class="form-group">
    <label for="first_name">Prénom *</label>
    <input
      type="text"
      id="first_name"
      formControlName="first_name"
      class="input"
      [class.error]="form.get('first_name')?.touched && form.get('first_name')?.invalid"
    />
    <div class="error-msg" *ngIf="form.get('first_name')?.touched && form.get('first_name')?.invalid">
      <span *ngIf="form.get('first_name')?.errors?.['required']">Le prénom est requis.</span>
      <span *ngIf="form.get('first_name')?.errors?.['minlength']">Le prénom doit contenir au moins 3 caractères.</span>
      <span *ngIf="form.get('first_name')?.errors?.['maxlength']">Le prénom ne peut pas dépasser 50 caractères.</span>
    </div>
  </div>

  <!-- Nom -->
  <div class="form-group">
    <label for="last_name">Nom *</label>
    <input
      type="text"
      id="last_name"
      formControlName="last_name"
      class="input"
      [class.error]="form.get('last_name')?.touched && form.get('last_name')?.invalid"
    />
    <div class="error-msg" *ngIf="form.get('last_name')?.touched && form.get('last_name')?.invalid">
      <span *ngIf="form.get('last_name')?.errors?.['required']">Le nom est requis.</span>
      <span *ngIf="form.get('last_name')?.errors?.['minlength']">Le nom doit contenir au moins 3 caractères.</span>
      <span *ngIf="form.get('last_name')?.errors?.['maxlength']">Le nom ne peut pas dépasser 50 caractères.</span>
    </div>
  </div>

  <!-- Âge -->
  <div class="form-group">
    <label for="age">Âge *</label>
    <input
      type="number"
      id="age"
      formControlName="age"
      min="1"
      max="99"
      class="input"
      [class.error]="form.get('age')?.touched && form.get('age')?.invalid"
    />
    <div class="error-msg" *ngIf="form.get('age')?.touched && form.get('age')?.invalid">
      <span *ngIf="form.get('age')?.errors?.['required']">L'âge est requis.</span>
      <span *ngIf="form.get('age')?.errors?.['min'] || form.get('age')?.errors?.['max']">L'âge doit être entre 1 et 99 ans.</span>
    </div>
  </div>

  <!-- Genre -->
  <div class="form-group">
    <label for="gender">Genre *</label>
    <select
      id="gender"
      formControlName="gender"
      class="select"
      [class.error]="form.get('gender')?.touched && form.get('gender')?.invalid"
    >
      <option value="">-- Sélectionner un genre --</option>
      <option *ngFor="let gender of genderOptions" [value]="gender">{{ gender }}</option>
    </select>
    <div class="error-msg" *ngIf="form.get('gender')?.touched && form.get('gender')?.invalid">
      Le genre est requis.
    </div>
  </div>

  <!-- Profil -->
  <div class="form-group">
    <label for="profile">Profil *</label>
    <select
      id="profile"
      formControlName="profile"
      class="select"
      [class.error]="form.get('profile')?.touched && form.get('profile')?.invalid"
    >
      <option value="">-- Sélectionner un profil --</option>
      <option *ngFor="let profile of profileOptions" [value]="profile">{{ profile }}</option>
    </select>
    <div class="error-msg" *ngIf="form.get('profile')?.touched && form.get('profile')?.invalid">
      Le profil est requis.
    </div>
  </div>

  <!-- Niveau de français -->
  <div class="form-group">
    <label for="french_level">Niveau de français * (1-4)</label>
    <select id="french_level" formControlName="french_level" class="select">
      <option [value]="1">1 - Débutant</option>
      <option [value]="2">2 - Intermédiaire</option>
      <option [value]="3">3 - Avancé</option>
      <option [value]="4">4 - Expert</option>
    </select>
  </div>

  <!-- Niveau technique -->
  <div class="form-group">
    <label for="tech_level">Niveau technique * (1-4)</label>
    <select id="tech_level" formControlName="tech_level" class="select">
      <option [value]="1">1 - Débutant</option>
      <option [value]="2">2 - Intermédiaire</option>
      <option [value]="3">3 - Avancé</option>
      <option [value]="4">4 - Expert</option>
    </select>
  </div>

  <!-- DWWM -->
  <div class="form-group checkbox">
    <input type="checkbox" id="dwwm" formControlName="dwwm">
    <label for="dwwm">DWWM (Développeur Web et Web Mobile)</label>
  </div>

  <!-- Boutons -->
  <div class="button-group">
    <button
      type="submit"
      class="btn btn-primary"
      [disabled]="form.invalid || isSubmitting"
    >
      {{ isSubmitting ? 'Ajout en cours...' : 'Ajouter' }}
    </button>
    <button
      type="button"
      class="btn btn-secondary"
      (click)="onCancel()"
      [disabled]="isSubmitting"
    >
      Annuler
    </button>
  </div>
</form>
